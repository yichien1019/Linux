åœ¨ Compute Engine ä¸­å»ºç«‹ä¸»å¾å¼æ‡‰ç”¨ç¨‹å¼

æ‚¨å¯ä»¥ç­è§£å¦‚ä½•åŸ·è¡Œä¸‹åˆ—ä½œæ¥­ï¼š

è¨­å®šå°ˆæ¡ˆ

    è«‹é¸å–ç¾æœ‰å°ˆæ¡ˆï¼Œæˆ–æ˜¯å»ºç«‹æ–°çš„å°ˆæ¡ˆã€‚

    å•Ÿç”¨ API
    æ­£åœ¨å•Ÿç”¨ API
    Compute Engine API

å»ºç«‹ä¼ºæœå™¨ VM

    åœ¨ Compute Engine é é¢ä¸Šï¼ŒæŒ‰ä¸€ä¸‹ã€ŒVM instancesã€(VM åŸ·è¡Œå€‹é«”)ã€‚

    å¦‚è¦æŸ¥çœ‹ç›¸é—œä½ç½®ï¼Œè«‹é»é¸ä¸‹åˆ—æŒ‰éˆ•ï¼š Compute Engine  VM åŸ·è¡Œå€‹é«”

    åœ¨ã€ŒVM instancesã€(VM åŸ·è¡Œå€‹é«”) é é¢ä¸Šï¼ŒæŒ‰ä¸€ä¸‹ã€ŒCreate instanceã€(å»ºç«‹åŸ·è¡Œå€‹é«”)ã€‚

    åœ¨ã€ŒNameã€(åç¨±) æ¬„ä½ä¸­è¼¸å…¥ serverã€‚

    åœ¨ã€ŒRegionã€(å€åŸŸ) æ¸…å–®ä¸­é¸å–ã€Œus-central1ã€ã€‚

    åœ¨ã€ŒZoneã€(å¯ç”¨å€) æ¸…å–®ä¸­é¸å–ã€Œus-central1-aã€ã€‚

    åœ¨ã€ŒMachine typeã€(æ©Ÿå™¨é¡å‹) æ¸…å–®ä¸­é¸å–ã€Œe2-microã€ã€‚

    åœ¨ã€ŒBoot diskã€(é–‹æ©Ÿç£ç¢Ÿ) ä¸­æŒ‰ä¸€ä¸‹ã€ŒChangeã€(è®Šæ›´)ï¼Œç„¶å¾Œï¼š

    åœ¨ã€ŒOperating systemã€(ä½œæ¥­ç³»çµ±) æ¸…å–®ä¸­é¸å–ã€ŒUbuntuã€ã€‚
    åœ¨ã€ŒVersionã€(ç‰ˆæœ¬) æ¸…å–®ä¸­é¸å–ã€ŒUbuntu 18.04 LTSã€ã€‚
    æŒ‰ä¸€ä¸‹ã€ŒSelectã€(é¸å–)ã€‚
    åœ¨ã€ŒFirewallã€(é˜²ç«ç‰†) å€æ®µä¸­ï¼Œé¸å–ã€ŒAllow HTTP trafficã€(å…è¨± HTTP æµé‡)ã€‚

    æŒ‰ä¸€ä¸‹ã€ŒCreateã€(å»ºç«‹)ã€‚

å»ºç«‹ç”¨æˆ¶ç«¯ VM

    åœ¨ã€ŒVM instancesã€(VM åŸ·è¡Œå€‹é«”) é é¢ä¸Šï¼ŒæŒ‰ä¸€ä¸‹ã€ŒCreate instanceã€(å»ºç«‹åŸ·è¡Œå€‹é«”)ã€‚

    åœ¨ã€ŒNameã€(åç¨±) æ¬„ä½ä¸­è¼¸å…¥ clientã€‚

    åœ¨ã€ŒRegionã€(å€åŸŸ) æ¸…å–®ä¸­é¸å–ã€Œus-central1ã€ã€‚

    åœ¨ã€ŒZoneã€(å¯ç”¨å€) æ¸…å–®ä¸­é¸å–ã€Œus-central1-aã€ã€‚

    åœ¨ã€ŒMachine typeã€(æ©Ÿå™¨é¡å‹) æ¸…å–®ä¸­é¸å–ã€Œe2-microã€ã€‚

    åœ¨ã€ŒBoot diskã€(é–‹æ©Ÿç£ç¢Ÿ) ä¸­æŒ‰ä¸€ä¸‹ã€ŒChangeã€(è®Šæ›´)ï¼Œç„¶å¾Œï¼š

    åœ¨ã€ŒOperating systemã€(ä½œæ¥­ç³»çµ±) æ¸…å–®ä¸­é¸å–ã€ŒUbuntuã€ã€‚
    åœ¨ã€ŒVersionã€(ç‰ˆæœ¬) æ¸…å–®ä¸­é¸å–ã€ŒUbuntu 18.04 LTSã€ã€‚
    æŒ‰ä¸€ä¸‹ã€ŒSelectã€(é¸å–)ã€‚
    åœ¨ã€ŒFirewallã€(é˜²ç«ç‰†) å€æ®µä¸­ï¼Œé¸å–ã€ŒAllow HTTP trafficã€(å…è¨± HTTP æµé‡)ã€‚

    æŒ‰ä¸€ä¸‹ã€ŒCreateã€(å»ºç«‹)ã€‚

    ç­‰å¾… VM å»ºç«‹ç¨‹åºå®Œæˆã€‚æŒ‰ä¸€ä¸‹ã€ŒNotificationsã€(é€šçŸ¥) æŒ‰éˆ•å³å¯æŸ¥çœ‹é€²åº¦ã€‚

åœ¨ä¼ºæœå™¨ VM ä¸Šå®‰è£åŠåŸ·è¡Œè³‡æ–™åº«

    æŒ‰ä¸€ä¸‹ã€ŒActivate Cloud Shellã€(å•Ÿç”¨ Cloud Shell) æŒ‰éˆ•ã€‚

    ä½¿ç”¨ SSH é€£ç·šè‡³ä¼ºæœå™¨ VMï¼š
    gcloud compute --project "crafty-coral-350106" ssh --zone us-central1-a server
    
    æ›´æ–°å¥—ä»¶ä¸¦å®‰è£è³‡æ–™åº«ï¼š
    sudo apt-get update
    sudo apt-get install -y mongodb

    åœæ­¢è³‡æ–™åº«ï¼Œç„¶å¾Œå°‡å…¶é‡æ–°è¨­å®šç‚ºåœ¨ç‰¹å®šè³‡æ–™å¤¾ä¸­åŸ·è¡Œï¼š
    sudo service mongodb stop
    sudo mkdir $HOME/db
    sudo mongod --dbpath $HOME/db \
        --port 80 --fork --logpath \
        /var/tmp/mongodb --bind_ip_all

    çµæŸ SSH å·¥ä½œéšæ®µï¼Œä¸¦ä¸­æ–·èˆ‡ä¼ºæœå™¨ VM çš„é€£ç·šï¼š
    exit

åœ¨ç”¨æˆ¶ç«¯ VM ä¸Šå®‰è£æ‡‰ç”¨ç¨‹å¼

    ä½¿ç”¨ SSH é€£ç·šè‡³ç”¨æˆ¶ç«¯ VMï¼š
    gcloud compute --project "crafty-coral-350106" ssh --zone us-central1-a client

    å®‰è£ä¾é™„å…ƒä»¶ï¼š
    curl -sL https://deb.nodesource.com/setup_14.x | sudo -E bash -
    sudo apt-get install git nodejs -y

    è¤‡è£½ç¯„ä¾‹æ‡‰ç”¨ç¨‹å¼ï¼š
    git clone https://github.com/GoogleCloudPlatform/todomvc-mongodb.git

    å®‰è£æ‡‰ç”¨ç¨‹å¼ä¾é™„å…ƒä»¶ï¼š
    cd todomvc-mongodb
    sudo npm install -g npm-check-updates
    sudo ncu -u
    sudo npm install

    å°‡ç¨‹å¼ç¢¼æŒ‡å‘æ­£ç¢ºçš„é€šè¨ŠåŸ ï¼š
    sed -i -e 's/8080/80/g' server.js

åœ¨ç”¨æˆ¶ç«¯ VM ä¸Šå•Ÿå‹•æ‡‰ç”¨ç¨‹å¼ã€‚





## ğŸ“– è£œå……è³‡æ–™
* [[æ‰‹æŠŠæ‰‹æ•™å­¸] ç‚º Google Cloud VM (GCE) è¨­å®šéœæ…‹ IP ä½å€](https://ikala.cloud/gce-static-ip-address/)
* [ç¬¬ä¸€æ¬¡åœ¨ GCP é–‹ VM å°±æˆåŠŸ](https://tech.ray247k.com/blog/202201-gcp-vm-basic/)


ğŸ–Šï¸ editor : yi-chien Liu




